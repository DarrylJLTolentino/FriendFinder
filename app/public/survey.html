<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Home Page - Friend Finder</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../css/style.css">
    <script src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>

</head>

<body background="../../images/cropped-1920-1080-601209.jpg">

    <div class="container">

        <h1 class="text-center"> "Through the Power of Friendship" </h1>

        <hr>

        <form>
            <div class="form-group">
                <label for="name">"Who Do You Think You Is?"</label>
                <input type="text" class="form-control" id="name" placeholder="Your Name.">
            </div>
            <div class="form-group">
                <label for="photoLink">"Look at this photograph. Everytime I do, it makes me laugh"</label>
                <input type="text" class="form-control" id="photoLink" placeholder="Your Photo Link">
            </div>
        </form>

        <hr>

        <div class="jumbotron text-center">
            <h3>Question 1</h3>
            <p>In the face of danger, you choose fight over flight</p>
            <select class="custom-select" id="choice1">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <h3>Question 2</h3>
            <p>If you are passing an injured person on the road, you find yourself obliged to help that person</p>
            <select class="custom-select" id="choice2">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <h3>Question 3</h3>
            <p>As a member of a party, you wouldn't mind betraying them if you gained something.</p>
            <select class="custom-select" id="choice3">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <h3>Question 4</h3>
            <p>You prefer raw magical power over physical abilities.</p>
            <select class="custom-select" id="choice4">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <h3>Question 5</h3>
            <p>You feel more comfortable up close than at range during combat</p>
            <select class="custom-select" id="choice5">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <h3>Question 6</h3>
            <p>You try hard to avoid conflict, but will confront it if needed</p>
            <select class="custom-select" id="choice6">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <h3>Question 7</h3>
            <p>You are constantly haunted by your past</p>
            <select class="custom-select" id="choice7">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <h3>Question 8</h3>
            <p>You would try to always challenge fate</p>
            <select class="custom-select" id="choice8">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <h3>Question 9</h3>
            <p>You are really easy to talk to</p>
            <select class="custom-select" id="choice9">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>

            <h3>Question 10</h3>
            <p>You would risk your own life to save a loved one</p>
            <select class="custom-select" id="choice10">
                <option value="1">1</option>
                <option value="2">2</option>
                <option selected value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
            <br><br>
            <button class="btn btn-lg btn-primary" id="submit" data-toggle="modal" data-target="#myModal"
                type="Submit">Submit</button>
        </div>

        <div class="modal" id="myModal" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header text-center">
                        <h5 class="modal-title">Congratulations! This is the person you are most compatible with!</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body text-center">
                        <h1 id="bestFriendName"></h1>
                        <img src="#" id="bestFriendPhoto">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-left">
            <a href="/api/friends" target="_blank">API Friend List</a> | <a
                href="https://github.com/DarrylJLTolentino/FriendFinder" target="_blank">GitHub Repository</a>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

    <script>
        var newFriendo = {};

        $('#myModal').on('shown.bs.modal', function () {
            $('#submit').trigger('focus')
        })

        $("#submit").on("click", function () {
            event.preventDefault();
            var answerArr = [];
            for (var i = 1; i < 11; i++) {
                var val = $("#choice" + i).val()
                answerArr.push(val);
            }
            // console.log(answerArr);

            newFriendo = {
                name: $("#name").val(),
                photo: $("#photoLink").val(),
                choice: answerArr
            }

            $.post("/api/friends", newFriendo, function (data) {
                console.log("Answers submitted.")
            });

            $.get("/api/friends", function (data) {
                var compareFriend;
                var currentUser = data[data.length - 1];
                var diffArr = [];
                var bestDiff = 20;
                var bestFriend = {};
                for (var i = 0; i < data.length - 1; i++) {
                    compareFriend = data[i];
                    var name = compareFriend.name;
                    var photo = compareFriend.photo;
                    // console.log(compareFriend);
                    for (var j = 0; j < compareFriend.choice.length; j++) {
                        // console.log(compareFriend.choice[j]);
                        var diff = Math.abs(currentUser.choice[j] - compareFriend.choice[j]);
                        diffArr.push(diff);
                    }

                    var sum = 0;

                    for (var k = 0; k < diffArr.length; k++) {
                        sum += diffArr[k];
                    }

                    if (sum < bestDiff) {
                        bestDiff = sum;
                        bestFriend = {
                            name: name,
                            photo: photo
                        }
                    }
                    diffArr = [];
                }
                $("#bestFriendName").text(bestFriend.name);
                $("#bestFriendPhoto").attr("src", bestFriend.photo);
                $("#bestFriendPhoto").css("height", "400px");
                $("#bestFriendPhoto").css("width", "400px");
                // console.log(diffArr);
                $('#myModal').modal('show');
            });
        });

    </script>

</body>

</html>